# 内存管理2

## 模型

下面为一段python脚本：

```python
a = 123
b = [1, 2, 3]
```

当这段脚本加载到内存后，内存会为数据123和[1, 2, 3]分配空间，并让变量a和b分别指向对应的数据：

![1](https://github.com/im-iron-man/python-gramma/blob/master/image/1.png)

进一步，你可以内置函数id来获取变量a，b引用对象在内存中的地址：

```python
print id(a) # 33924320
print id(b) # 37926192
```

具体如图所示：

![1](https://github.com/im-iron-man/python-gramma/blob/master/image/2.png)

## 引用计数

事实上，当python脚本加载到内存后，内存不仅为对象分配空间，让变量引用对象，而且还会维护一个引用计数表，用来监控当前对象的被引用情况。所以一旦一个对象的引用计数为0，就意味着没有变量指向该对象，那么python解释器会自动释放掉该对象占用的内存空间。

下面以三段python脚本为例：

```python
a = 123
b = 123
print id(a) == id(b) # True
```

![1](https://github.com/im-iron-man/python-gramma/blob/master/image/3.png)

```python
a = 123456789
b = 123456789
print id(a) == id(b) # False
```

![1](https://github.com/im-iron-man/python-gramma/blob/master/image/4.png)

```python
a = 123
b = 123
del a # 删除了变量a对123对象的引用，123对象被引用次数减1，此时123对象的被引用次数为1。
del b # 删除了变量b对123对象的引用，123对象被引用次数减1，此时123对象的被引用次数为0。因此123对象占用的内存被释放。
```

## 可变对象与不可变对象

## 拷贝